 <!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KnowledgeBase - Professional Documentation Platform</title>
    <!-- <link rel="stylesheet" href="https://raw.githubusercontent.com/Atharv-Chaudhari/Artificial-Intelligence/refs/heads/main/style.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>
         /* style.css */
/* KnowledgeBase - Professional Documentation Platform Styles */

:root {
    --primary: #0066FF;
    --primary-dark: #0052CC;
    --primary-light: #4D94FF;
    --secondary: #6554C0;
    --success: #36B37E;
    --danger: #FF5630;
    --warning: #FFAB00;

    --bg-1: #FFFFFF;
    --bg-2: #F4F5F7;
    --bg-3: #EBECF0;
    --bg-4: #DFE1E6;

    --text-1: #172B4D;
    --text-2: #42526E;
    --text-3: #6B778C;
    --text-4: #97A0AF;

    --border: #DFE1E6;
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
    --shadow-md: 0 4px 12px rgba(0,0,0,0.15);
    --shadow-lg: 0 8px 24px rgba(0,0,0,0.2);
    --shadow-xl: 0 20px 60px rgba(0,0,0,0.3);

    --radius-sm: 4px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-xl: 16px;

    --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);

    --glass-bg: rgba(255, 255, 255, 0.7);
    --glass-border: rgba(255, 255, 255, 0.18);
}

[data-theme="dark"] {
    --bg-1: #1C1F26;
    --bg-2: #252932;
    --bg-3: #2D323E;
    --bg-4: #363B47;

    --text-1: #F4F5F7;
    --text-2: #DFE1E6;
    --text-3: #B3BAC5;
    --text-4: #8993A4;

    --border: #3D4352;

    --glass-bg: rgba(28, 31, 38, 0.7);
    --glass-border: rgba(255, 255, 255, 0.1);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
    background: var(--bg-2);
    color: var(--text-1);
    overflow: hidden;
    height: 100vh;
    position: relative;
}

/* ===== PARTICLES BACKGROUND ===== */
#particles-js {
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    z-index: -1;
    opacity: 0.6;
}

/* ===== LOADING OVERLAY ===== */
.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    transition: opacity 0.5s, visibility 0.5s;
}

.loading-overlay.hidden {
    opacity: 0;
    visibility: hidden;
}

.loading-spinner {
    text-align: center;
    color: white;
}

.spinner {
    width: 60px;
    height: 60px;
    margin: 0 auto 20px;
    border: 4px solid rgba(255,255,255,0.3);
    border-top-color: white;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* ===== GLASSMORPHISM EFFECTS ===== */
.glass-effect {
    background: var(--glass-bg);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid var(--glass-border);
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}

.glass-modal {
    background: var(--glass-bg);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border: 1px solid var(--glass-border);
}

/* ===== GRADIENT TEXT ===== */
.gradient-text {
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

/* ===== TOP NAVIGATION ===== */
.top-nav {
    height: 60px;
    background: var(--bg-1);
    border-bottom: 2px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 24px;
    box-shadow: var(--shadow-sm);
    position: relative;
    z-index: 100;
}

.nav-left {
    display: flex;
    align-items: center;
    gap: 32px;
}

.logo {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 20px;
    font-weight: 700;
    color: var(--primary);
}

.logo i {
    font-size: 28px;
}

.nav-modes {
    display: flex;
    gap: 8px;
}

.nav-mode-btn {
    padding: 8px 20px;
    border: none;
    background: transparent;
    color: var(--text-2);
    border-radius: var(--radius-md);
    cursor: pointer;
    font-weight: 500;
    font-size: 14px;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 8px;
}

.nav-mode-btn:hover {
    background: var(--bg-2);
    color: var(--text-1);
}

.nav-mode-btn.active {
    background: var(--primary);
    color: white;
}

.nav-right {
    display: flex;
    align-items: center;
    gap: 16px;
}

.search-container {
    position: relative;
    display: flex;
    align-items: center;
}

.search-container i {
    position: absolute;
    left: 12px;
    color: var(--text-3);
}

.search-container input {
    width: 300px;
    padding: 8px 12px 8px 36px;
    border: 2px solid var(--border);
    border-radius: var(--radius-md);
    background: var(--bg-2);
    color: var(--text-1);
    font-size: 14px;
    transition: var(--transition);
}

.search-container input:focus {
    outline: none;
    border-color: var(--primary);
    background: var(--bg-1);
}

.icon-btn {
    width: 36px;
    height: 36px;
    border: none;
    background: transparent;
    color: var(--text-2);
    border-radius: var(--radius-md);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}

.icon-btn:hover {
    background: var(--bg-2);
    color: var(--text-1);
}

/* ===== VIEW CONTAINERS ===== */
.view-container {
    display: none;
    height: calc(100vh - 60px);
    overflow: hidden;
}

.view-container.active {
    display: block;
}

/* ===== HOME VIEW ===== */
#homeView {
    overflow-y: auto;
    padding: 48px;
}

.home-hero {
    text-align: center;
    margin-bottom: 64px;
}

.hero-badge {
    display: inline-block;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    color: white;
    padding: 8px 20px;
    border-radius: 50px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 24px;
    animation: float 3s ease-in-out infinite;
}

@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.home-hero h1 {
    font-size: 48px;
    font-weight: 700;
    margin-bottom: 16px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.home-hero p {
    font-size: 20px;
    color: var(--text-2);
}

.hero-stats {
    display: flex;
    justify-content: center;
    gap: 32px;
    margin-top: 32px;
    flex-wrap: wrap;
}

.stat-pill {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    padding: 12px 24px;
    border-radius: 50px;
    font-size: 14px;
    font-weight: 600;
}

.stat-pill i {
    color: var(--primary);
}

.home-actions {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 24px;
    max-width: 1200px;
    margin: 0 auto 64px;
}

.action-card {
    background: var(--bg-1);
    border: 2px solid var(--border);
    border-radius: var(--radius-lg);
    padding: 32px;
    cursor: pointer;
    transition: var(--transition);
    text-align: center;
    position: relative;
    overflow: hidden;
}

.action-card:hover {
    transform: translateY(-8px);
    box-shadow: var(--shadow-xl);
    border-color: var(--primary);
}

.card-hover-effect {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, transparent 0%, var(--primary) 100%);
    opacity: 0;
    transition: opacity var(--transition-normal);
    pointer-events: none;
}

.action-card:hover .card-hover-effect {
    opacity: 0.05;
}

.action-icon {
    width: 80px;
    height: 80px;
    margin: 0 auto 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 36px;
    color: white;
}

.action-card h3 {
    font-size: 20px;
    margin-bottom: 12px;
    color: var(--text-1);
}

.action-card p {
    color: var(--text-3);
    font-size: 14px;
}

.recent-section {
    max-width: 1200px;
    margin: 0 auto 48px;
}

.recent-section h2 {
    font-size: 24px;
    margin-bottom: 24px;
    display: flex;
    align-items: center;
    gap: 12px;
}

.recent-docs {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 16px;
}

.recent-doc-card {
    background: var(--bg-1);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    padding: 20px;
    cursor: pointer;
    transition: var(--transition);
}

.recent-doc-card:hover {
    box-shadow: var(--shadow-md);
    border-color: var(--primary);
}

.recent-doc-card h4 {
    font-size: 16px;
    margin-bottom: 8px;
    color: var(--text-1);
}

.recent-doc-card p {
    font-size: 13px;
    color: var(--text-3);
    margin-bottom: 12px;
}

.recent-doc-meta {
    display: flex;
    justify-content: space-between;
    font-size: 12px;
    color: var(--text-4);
}

.stats-section {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 24px;
    max-width: 1200px;
    margin: 0 auto;
}

.stat-card {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 24px;
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    gap: 20px;
    position: relative;
    overflow: hidden;
    transition: transform var(--transition-normal);
}

.stat-card-animated {
    animation: slideInUp 0.6s ease-out;
}

@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.stat-card:hover {
    transform: scale(1.05);
}

.sparkline {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 40px;
    opacity: 0.3;
    background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.5) 50%, transparent 100%);
}

.stat-card i {
    font-size: 36px;
    opacity: 0.9;
}

.stat-card h3 {
    font-size: 32px;
    font-weight: 700;
    margin: 0;
}

.stat-card p {
    font-size: 14px;
    opacity: 0.9;
    margin: 4px 0 0 0;
}

/* ===== EDIT VIEW ===== */
.split-layout {
    display: flex;
    height: 100%;
}

.folder-sidebar {
    width: 280px;
    background: var(--bg-1);
    border-right: 2px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.sidebar-header {
    padding: 20px;
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.sidebar-header h3 {
    font-size: 16px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
}

.sidebar-actions {
    display: flex;
    gap: 4px;
}

.tree-search {
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 8px;
    background: var(--bg-2);
}

.tree-search i {
    color: var(--text-3);
    font-size: 14px;
}

.tree-search input {
    flex: 1;
    border: none;
    background: transparent;
    color: var(--text-1);
    font-size: 13px;
    outline: none;
}

.folder-tree {
    flex: 1;
    overflow-y: auto;
    padding: 8px;
}

.tree-item {
    padding: 8px 12px;
    margin: 2px 0;
    border-radius: var(--radius-sm);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    color: var(--text-2);
    transition: var(--transition);
    user-select: none;
}

.tree-item:hover {
    background: var(--bg-2);
    color: var(--text-1);
}

.tree-item.active {
    background: var(--primary);
    color: white;
}

.tree-item.folder {
    font-weight: 500;
}

.tree-item .icon {
    font-size: 16px;
}

.tree-item .expand-icon {
    font-size: 10px;
    margin-right: 4px;
    transition: transform 0.2s;
}

.tree-item.expanded .expand-icon {
    transform: rotate(90deg);
}

.tree-children {
    margin-left: 20px;
}

/* ===== EDITOR AREA ===== */
.editor-area {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.breadcrumb {
    padding: 12px 24px;
    background: var(--bg-2);
    border-bottom: 1px solid var(--border);
    font-size: 13px;
    color: var(--text-3);
}

.breadcrumb span {
    display: flex;
    align-items: center;
    gap: 8px;
}

.editor-header {
    padding: 20px 24px;
    background: var(--bg-1);
    border-bottom: 2px solid var(--border);
}

.doc-title-input {
    width: 100%;
    border: none;
    background: transparent;
    font-size: 28px;
    font-weight: 700;
    color: var(--text-1);
    margin-bottom: 16px;
    outline: none;
}

.editor-meta {
    display: flex;
    align-items: center;
    gap: 16px;
}

.category-select {
    padding: 8px 12px;
    border: 2px solid var(--border);
    border-radius: var(--radius-md);
    background: var(--bg-2);
    color: var(--text-1);
    font-size: 14px;
    cursor: pointer;
    outline: none;
    transition: var(--transition);
}

.category-select:focus {
    border-color: var(--primary);
}

.editor-actions {
    margin-left: auto;
    display: flex;
    gap: 12px;
}

.btn {
    padding: 8px 16px;
    border: none;
    border-radius: var(--radius-md);
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: var(--transition);
}

.btn-sm {
    padding: 6px 12px;
    font-size: 13px;
}

.btn-primary {
    background: var(--primary);
    color: white;
}

.btn-primary:hover {
    background: var(--primary-dark);
    transform: translateY(-1px);
}

.btn-success {
    background: var(--success);
    color: white;
}

.btn-success:hover {
    background: #2A9D6F;
}

.btn-danger {
    background: var(--danger);
    color: white;
}

.btn-danger:hover {
    background: #DE350B;
}

.btn-secondary {
    background: var(--bg-3);
    color: var(--text-1);
}

.btn-secondary:hover {
    background: var(--bg-4);
}

/* ===== TOOLBAR ===== */
.toolbar {
    padding: 12px 24px;
    background: var(--bg-1);
    border-bottom: 1px solid var(--border);
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    align-items: center;
}

.toolbar-group {
    display: flex;
    gap: 4px;
    padding-right: 12px;
    border-right: 1px solid var(--border);
}

.toolbar-group:last-child {
    border-right: none;
}

.tool-btn {
    width: 32px;
    height: 32px;
    border: none;
    background: transparent;
    color: var(--text-2);
    border-radius: var(--radius-sm);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    transition: var(--transition);
    position: relative;
}

.tool-btn:hover {
    background: var(--bg-2);
    color: var(--text-1);
}

.tool-btn:active {
    transform: scale(0.95);
}

/* ===== EDITOR WORKSPACE ===== */
.editor-workspace {
    flex: 1;
    display: flex;
    overflow: hidden;
}

.editor-pane {
    flex: 1;
    background: var(--bg-1);
    border-right: 1px solid var(--border);
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

#markdownEditor {
    flex: 1;
    width: 100%;
    padding: 24px;
    border: none;
    background: transparent;
    color: var(--text-1);
    font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
    font-size: 14px;
    line-height: 1.7;
    resize: none;
    outline: none;
}

.preview-pane {
    flex: 1;
    background: var(--bg-2);
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.preview-header {
    padding: 16px 24px;
    background: var(--bg-1);
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.preview-header h4 {
    font-size: 14px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--text-2);
}

.preview-content {
    flex: 1;
    padding: 24px;
    overflow-y: auto;
    max-width: 900px;
    margin: 0 auto;
    width: 100%;
}

/* ===== PREVIEW STYLING ===== */
.preview-content h1,
.preview-content h2,
.preview-content h3,
.preview-content h4,
.preview-content h5,
.preview-content h6 {
    margin-top: 24px;
    margin-bottom: 16px;
    font-weight: 600;
    line-height: 1.3;
    color: var(--text-1);
}

.preview-content h1 {
    font-size: 36px;
    padding-bottom: 12px;
    border-bottom: 2px solid var(--border);
}

.preview-content h2 {
    font-size: 28px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--border);
}

.preview-content h3 { font-size: 22px; }
.preview-content h4 { font-size: 18px; }
.preview-content h5 { font-size: 16px; }
.preview-content h6 { font-size: 14px; }

.preview-content p {
    margin-bottom: 16px;
    line-height: 1.7;
    color: var(--text-2);
}

.preview-content code {
    background: var(--bg-3);
    padding: 2px 8px;
    border-radius: var(--radius-sm);
    font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
    font-size: 13px;
    color: var(--danger);
}

.preview-content pre {
    background: #282c34;
    padding: 20px;
    border-radius: var(--radius-md);
    overflow-x: auto;
    margin: 20px 0;
    position: relative;
}

.preview-content pre code {
    background: transparent;
    padding: 0;
    color: #abb2bf;
    font-size: 13px;
}

.preview-content blockquote {
    border-left: 4px solid var(--primary);
    padding-left: 20px;
    margin: 20px 0;
    color: var(--text-3);
    font-style: italic;
}

.preview-content ul,
.preview-content ol {
    margin: 16px 0;
    padding-left: 32px;
}

.preview-content li {
    margin-bottom: 8px;
    line-height: 1.6;
    color: var(--text-2);
}

.preview-content a {
    color: var(--primary);
    text-decoration: none;
    font-weight: 500;
}

.preview-content a:hover {
    text-decoration: underline;
}

.preview-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    margin: 20px 0;
    box-shadow: var(--shadow-md);
}

.preview-content table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    background: var(--bg-1);
    border-radius: var(--radius-md);
    overflow: hidden;
}

.preview-content table th,
.preview-content table td {
    border: 1px solid var(--border);
    padding: 12px 16px;
    text-align: left;
}

.preview-content table th {
    background: var(--bg-3);
    font-weight: 600;
    color: var(--text-1);
}

.preview-content hr {
    border: none;
    border-top: 2px solid var(--border);
    margin: 32px 0;
}

/* Python Executable Code Block */
.python-executable {
    position: relative;
    margin: 20px 0;
}

.code-run-btn {
    position: absolute;
    top: 12px;
    right: 12px;
    padding: 6px 12px;
    background: var(--success);
    color: white;
    border: none;
    border-radius: var(--radius-sm);
    font-size: 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    z-index: 10;
    transition: var(--transition);
}

.code-run-btn:hover {
    background: #2A9D6F;
}

/* ===== PYTHON PANEL ===== */
.python-panel {
    display: none;
    height: 300px;
    background: var(--bg-1);
    border-top: 2px solid var(--border);
    flex-direction: column;
}

.python-panel.active {
    display: flex;
}

.panel-header {
    padding: 12px 20px;
    background: var(--bg-2);
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.panel-header h4 {
    font-size: 14px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
}

.panel-actions {
    display: flex;
    gap: 8px;
    align-items: center;
}

.panel-content {
    flex: 1;
    overflow: hidden;
}

.python-output {
    height: 100%;
    padding: 16px;
    font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
    font-size: 13px;
    overflow-y: auto;
    background: #1e1e1e;
    color: #d4d4d4;
}

.output-info {
    color: #4EC9B0;
    display: flex;
    align-items: center;
    gap: 8px;
}

.output-success {
    color: #4EC9B0;
}

.output-error {
    color: #f48771;
}

.output-line {
    margin: 4px 0;
    padding: 4px 0;
}

/* ===== VIEW MODE ===== */
.view-layout {
    display: flex;
    height: 100%;
}

.view-sidebar {
    width: 320px;
    background: var(--bg-1);
    border-right: 2px solid var(--border);
    display: flex;
    flex-direction: column;
}

.view-tree-search {
    padding: 12px 16px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 8px;
    background: var(--bg-2);
}

.view-tree-search i {
    color: var(--text-3);
}

.view-tree-search input {
    flex: 1;
    border: none;
    background: transparent;
    color: var(--text-1);
    font-size: 14px;
    outline: none;
}

.view-folder-tree {
    flex: 1;
    overflow-y: auto;
    padding: 12px;
}

.document-viewer {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background: var(--bg-1);
}

.doc-header {
    padding: 20px 32px;
    border-bottom: 2px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: var(--bg-2);
}

.doc-breadcrumb {
    font-size: 14px;
    color: var(--text-3);
}

.doc-actions {
    display: flex;
    gap: 12px;
}

.document-content {
    flex: 1;
    overflow-y: auto;
    padding: 48px 64px;
    max-width: 1100px;
    margin: 0 auto;
    width: 100%;
}

.welcome-message {
    text-align: center;
    padding: 64px 32px;
    color: var(--text-3);
}

.welcome-message i {
    font-size: 64px;
    margin-bottom: 24px;
    opacity: 0.5;
}

.welcome-message h2 {
    font-size: 28px;
    margin-bottom: 12px;
    color: var(--text-2);
}

.doc-footer {
    padding: 20px 64px;
    border-top: 1px solid var(--border);
    background: var(--bg-2);
}

.doc-meta {
    display: flex;
    gap: 24px;
    font-size: 13px;
    color: var(--text-3);
}

/* ===== MODALS ===== */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
}

.modal.active {
    display: flex;
}

.modal-content {
    background: var(--glass-bg);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-xl);
    max-width: 600px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    animation: modalSlideIn 0.3s ease-out;
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.modal-header {
    padding: 24px;
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-header h3 {
    font-size: 20px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 12px;
}

.modal-close {
    width: 32px;
    height: 32px;
    border: none;
    background: transparent;
    font-size: 24px;
    color: var(--text-3);
    cursor: pointer;
    border-radius: var(--radius-sm);
    transition: var(--transition);
}

.modal-close:hover {
    background: var(--bg-2);
    color: var(--text-1);
}

.modal-body {
    padding: 24px;
}

.modal-body label {
    display: block;
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 8px;
    margin-top: 16px;
    color: var(--text-2);
}

.modal-body label:first-child {
    margin-top: 0;
}

.modal-body input[type="text"],
.modal-body select {
    width: 100%;
    padding: 10px 12px;
    border: 2px solid var(--border);
    border-radius: var(--radius-md);
    background: var(--bg-2);
    color: var(--text-1);
    font-size: 14px;
    outline: none;
    transition: var(--transition);
}

.modal-body input:focus,
.modal-body select:focus {
    border-color: var(--primary);
    background: var(--bg-1);
}

.icon-picker {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    margin-top: 8px;
}

.icon-option {
    width: 48px;
    height: 48px;
    border: 2px solid var(--border);
    background: var(--bg-2);
    border-radius: var(--radius-md);
    font-size: 24px;
    cursor: pointer;
    transition: var(--transition);
}

.icon-option:hover {
    border-color: var(--primary);
    transform: scale(1.05);
}

.icon-option.selected {
    border-color: var(--primary);
    background: var(--primary);
}

.modal-footer {
    padding: 20px 24px;
    border-top: 1px solid var(--border);
    display: flex;
    justify-content: flex-end;
    gap: 12px;
}

.import-export-options {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

.option-card {
    text-align: center;
    padding: 24px;
    border: 2px solid var(--border);
    border-radius: var(--radius-md);
    background: var(--bg-2);
}

.option-card i {
    font-size: 48px;
    color: var(--primary);
    margin-bottom: 16px;
}

.option-card h4 {
    font-size: 16px;
    margin-bottom: 8px;
}

.option-card p {
    font-size: 13px;
    color: var(--text-3);
    margin-bottom: 16px;
}

/* ===== SCROLLBAR ===== */
::-webkit-scrollbar {
    width: 12px;
    height: 12px;
}

::-webkit-scrollbar-track {
    background: var(--bg-2);
}

::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 6px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--text-4);
}

/* ===== RESPONSIVE ===== */
@media (max-width: 1024px) {
    .editor-workspace {
        flex-direction: column;
    }

    .search-container input {
        width: 200px;
    }

    .folder-sidebar {
        width: 240px;
    }
}

@media (max-width: 768px) {
    .nav-modes {
        display: none;
    }

    .search-container {
        display: none;
    }

    #homeView {
        padding: 24px 16px;
    }

    .home-actions {
        grid-template-columns: 1fr;
    }

    .folder-sidebar,
    .view-sidebar {
        position: absolute;
        left: -280px;
        height: 100%;
        z-index: 50;
        transition: left 0.3s;
    }

    .folder-sidebar.mobile-open,
    .view-sidebar.mobile-open {
        left: 0;
    }
}

/* ===== ANIMATIONS ===== */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes slideIn {
    from {
        transform: translateX(-20px);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.tree-item,
.action-card,
.recent-doc-card {
    animation: fadeIn 0.3s ease;
}

/* ===== TOAST NOTIFICATIONS ===== */
.toast-container {
    position: fixed;
    bottom: 24px;
    right: 24px;
    z-index: 10001;
    display: flex;
    flex-direction: column;
    gap: 12px;
    pointer-events: none;
}

.toast {
    background: var(--glass-bg);
    backdrop-filter: blur(20px);
    border: 1px solid var(--glass-border);
    padding: 16px 20px;
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-lg);
    min-width: 300px;
    display: flex;
    align-items: center;
    gap: 12px;
    animation: toastSlideIn 0.3s ease-out;
    pointer-events: all;
}

.toast.success {
    border-left: 4px solid #10b981;
}

.toast.error {
    border-left: 4px solid #ef4444;
}

.toast.info {
    border-left: 4px solid var(--primary);
}

.toast i {
    font-size: 20px;
}

.toast.success i {
    color: #10b981;
}

.toast.error i {
    color: #ef4444;
}

.toast.info i {
    color: var(--primary);
}

.toast-message {
    flex: 1;
    font-size: 14px;
}

@keyframes toastSlideIn {
    from {
        opacity: 0;
        transform: translateX(100px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

    </style>
    <script>
      //  app.js
// KnowledgeBase - Professional Documentation Platform
// Main Application Logic

class KnowledgeBase {
    constructor() {
        this.folders = [];
        this.documents = [];
        this.currentDocId = null;
        this.currentFolderId = null;
        this.currentMode = 'home';
        this.theme = 'light';
        this.pyodide = null;
        this.pyodideLoading = false;

        // GitHub Configuration
        this.githubConfig = {
            token: '',
            owner: 'Atharv-Chaudhari',
            repo: 'Artificial-Intelligence',
            branch: 'main',
            commitTemplate: 'Update documentation: {filename}',
            autoCommit: false,
            syncFolderStructure: true
        };

        // App Settings
        this.settings = {
            theme: 'dark',
            accentColor: '#6366f1',
            enableParticles: true,
            enableAnimations: true,
            editorFontSize: 14,
            autoSave: true,
            livePreview: true,
            pythonPreload: false
        };

        this.init();
    }

    async init() {
        this.loadData();
        this.loadGitHubConfig();
        this.loadSettings();
        this.setupEventListeners();
        this.setupMarkdown();
        this.loadTheme();
        this.updateStats();
        this.renderRecentDocs();
        this.renderFolderTree();
        this.switchMode('home');
        this.applySettings();
        this.initializeParticles();
        this.updateGitHubStatus();

        // Hide loading overlay
        setTimeout(() => {
            document.querySelector('.loading-overlay')?.classList.add('hidden');
        }, 1000);
    }

    // ===== DATA MANAGEMENT =====
    loadData() {
        try {
            const foldersData = localStorage.getItem('kb_folders');
            const docsData = localStorage.getItem('kb_documents');

            this.folders = foldersData ? JSON.parse(foldersData) : [];
            this.documents = docsData ? JSON.parse(docsData) : [];
        } catch (err) {
            console.error('Failed to load data:', err);
            this.folders = [];
            this.documents = [];
        }
    }

    saveData() {
        try {
            localStorage.setItem('kb_folders', JSON.stringify(this.folders));
            localStorage.setItem('kb_documents', JSON.stringify(this.documents));
        } catch (err) {
            console.error('Failed to save data:', err);
            this.showNotification('Failed to save data', 'error');
        }
    }

    // ===== MARKDOWN SETUP =====
    setupMarkdown() {
        if (typeof marked !== 'undefined') {
            marked.setOptions({
                highlight: function(code, lang) {
                    if (window.hljs && lang && hljs.getLanguage(lang)) {
                        try {
                            return hljs.highlight(code, { language: lang }).value;
                        } catch (err) {}
                    }
                    return window.hljs ? hljs.highlightAuto(code).value : code;
                },
                breaks: true,
                gfm: true
            });
        }
    }

    // ===== EVENT LISTENERS =====
    setupEventListeners() {
        // Mode switching
        document.querySelectorAll('.nav-mode-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const mode = e.currentTarget.dataset.mode;
                this.switchMode(mode);
            });
        });

        // Theme toggle
        const themeToggle = document.getElementById('themeToggle');
        if (themeToggle) {
            themeToggle.addEventListener('click', () => {
                this.toggleTheme();
            });
        }

        // Home actions
        const createDocCard = document.getElementById('createDocCard');
        if (createDocCard) {
            createDocCard.addEventListener('click', () => {
                this.switchMode('edit');
                this.createNewDocument();
            });
        }

        const createFolderCard = document.getElementById('createFolderCard');
        if (createFolderCard) {
            createFolderCard.addEventListener('click', () => {
                this.openFolderModal();
            });
        }

        const viewDocsCard = document.getElementById('viewDocsCard');
        if (viewDocsCard) {
            viewDocsCard.addEventListener('click', () => {
                this.switchMode('view');
            });
        }

        const importDataCard = document.getElementById('importDataCard');
        if (importDataCard) {
            importDataCard.addEventListener('click', () => {
                this.openImportExportModal();
            });
        }

        // Folder management
        const newFolderBtn = document.getElementById('newFolderBtn');
        if (newFolderBtn) {
            newFolderBtn.addEventListener('click', () => {
                this.openFolderModal();
            });
        }

        const newDocInTreeBtn = document.getElementById('newDocInTreeBtn');
        if (newDocInTreeBtn) {
            newDocInTreeBtn.addEventListener('click', () => {
                this.createNewDocument();
            });
        }

        const createFolderBtn = document.getElementById('createFolderBtn');
        if (createFolderBtn) {
            createFolderBtn.addEventListener('click', () => {
                this.createFolder();
            });
        }

        const cancelFolderBtn = document.getElementById('cancelFolderBtn');
        if (cancelFolderBtn) {
            cancelFolderBtn.addEventListener('click', () => {
                this.closeFolderModal();
            });
        }

        // Icon picker
        document.querySelectorAll('.icon-option').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.icon-option').forEach(b => b.classList.remove('selected'));
                e.currentTarget.classList.add('selected');
                const selectedIcon = document.getElementById('selectedIcon');
                if (selectedIcon) selectedIcon.value = e.currentTarget.dataset.icon;
            });
        });

        // Editor
        const markdownEditor = document.getElementById('markdownEditor');
        if (markdownEditor) {
            markdownEditor.addEventListener('input', () => {
                this.updatePreview();
            });
        }

        const docTitle = document.getElementById('docTitle');
        if (docTitle) {
            docTitle.addEventListener('input', () => {
                if (this.currentDocId) {
                    const doc = this.getDocumentById(this.currentDocId);
                    if (doc) doc.title = docTitle.value || 'Untitled';
                }
            });
        }

        const saveDocBtn = document.getElementById('saveDocBtn');
        if (saveDocBtn) {
            saveDocBtn.addEventListener('click', () => {
                this.saveCurrentDocument();
            });
        }

        const deleteDocBtn = document.getElementById('deleteDocBtn');
        if (deleteDocBtn) {
            deleteDocBtn.addEventListener('click', () => {
                this.deleteCurrentDocument();
            });
        }

        // Toolbar
        document.querySelectorAll('.tool-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const action = e.currentTarget.dataset.action;
                if (action) this.applyFormat(action);
            });
        });

        // Image upload
        const imageBtn = document.querySelector('.tool-btn[data-action="image"]');
        if (imageBtn) {
            imageBtn.addEventListener('click', () => {
                const imageUploadInput = document.getElementById('imageUploadInput');
                if (imageUploadInput) imageUploadInput.click();
            });
        }

        const imageUploadInput = document.getElementById('imageUploadInput');
        if (imageUploadInput) {
            imageUploadInput.addEventListener('change', (e) => {
                if (e.target.files[0]) this.handleImageUpload(e.target.files[0]);
            });
        }

        // Python execution
        const runPythonBtn = document.getElementById('runPythonBtn');
        if (runPythonBtn) {
            runPythonBtn.addEventListener('click', () => {
                this.runPythonCode();
            });
        }

        const clearOutputBtn = document.getElementById('clearOutputBtn');
        if (clearOutputBtn) {
            clearOutputBtn.addEventListener('click', () => {
                const pythonOutput = document.getElementById('pythonOutput');
                if (pythonOutput) pythonOutput.innerHTML = '<div class="output-info"><i class="fas fa-info-circle"></i> Output cleared.</div>';
            });
        }

        const closePythonBtn = document.getElementById('closePythonBtn');
        if (closePythonBtn) {
            closePythonBtn.addEventListener('click', () => {
                const pythonPanel = document.getElementById('pythonPanel');
                if (pythonPanel) pythonPanel.classList.remove('active');
            });
        }

        // Import/Export
        const exportAllBtn = document.getElementById('exportAllBtn');
        if (exportAllBtn) {
            exportAllBtn.addEventListener('click', () => {
                this.exportData();
            });
        }

        const importFileBtn = document.getElementById('importFileBtn');
        if (importFileBtn) {
            importFileBtn.addEventListener('click', () => {
                const importFileInput = document.getElementById('importFileInput');
                if (importFileInput) importFileInput.click();
            });
        }

        const importFileInput = document.getElementById('importFileInput');
        if (importFileInput) {
            importFileInput.addEventListener('change', (e) => {
                if (e.target.files[0]) this.importData(e.target.files[0]);
            });
        }

        // Modal close buttons
        document.querySelectorAll('.modal-close').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.target.closest('.modal').classList.remove('active');
            });
        });

        // GitHub Settings - SAFE ACCESS
        const githubBtn = document.getElementById('githubBtn');
        if (githubBtn) {
            githubBtn.addEventListener('click', () => {
                const githubModal = document.getElementById('githubModal');
                if (githubModal) {
                    githubModal.classList.add('active');
                    this.loadGitHubSettings();
                }
            });
        }

        const saveGitHubBtn = document.getElementById('saveGitHubBtn');
        if (saveGitHubBtn) {
            saveGitHubBtn.addEventListener('click', () => {
                this.saveGitHubSettings();
            });
        }

        const testGitHubBtn = document.getElementById('testGitHubBtn');
        if (testGitHubBtn) {
            testGitHubBtn.addEventListener('click', () => {
                this.testGitHubConnection();
            });
        }

        const toggleTokenBtn = document.getElementById('toggleTokenBtn');
        if (toggleTokenBtn) {
            toggleTokenBtn.addEventListener('click', () => {
                const input = document.getElementById('githubToken');
                if (input) {
                    const icon = toggleTokenBtn.querySelector('i');
                    if (input.type === 'password') {
                        input.type = 'text';
                        if (icon) icon.className = 'fas fa-eye-slash';
                    } else {
                        input.type = 'password';
                        if (icon) icon.className = 'fas fa-eye';
                    }
                }
            });
        }

        // App Settings
        const settingsBtn = document.getElementById('settingsBtn');
        if (settingsBtn) {
            settingsBtn.addEventListener('click', () => {
                const settingsModal = document.getElementById('settingsModal');
                if (settingsModal) {
                    settingsModal.classList.add('active');
                    this.loadAppSettings();
                }
            });
        }

        const saveSettingsBtn = document.getElementById('saveSettingsBtn');
        if (saveSettingsBtn) {
            saveSettingsBtn.addEventListener('click', () => {
                this.saveAppSettings();
            });
        }

        // View mode
        const editCurrentBtn = document.getElementById('editCurrentBtn');
        if (editCurrentBtn) {
            editCurrentBtn.addEventListener('click', () => {
                if (this.currentDocId) {
                    this.switchMode('edit');
                    this.loadDocumentInEditor(this.currentDocId);
                }
            });
        }

        // GitHub Sync Button
        const githubSyncBtn = document.getElementById('githubSyncBtn');
        if (githubSyncBtn) {
            githubSyncBtn.addEventListener('click', () => {
                this.manualGitHubSync();
            });
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                if (e.key === 's') {
                    e.preventDefault();
                    if (this.currentMode === 'edit') this.saveCurrentDocument();
                } else if (e.key === 'b') {
                    e.preventDefault();
                    this.applyFormat('bold');
                } else if (e.key === 'i') {
                    e.preventDefault();
                    this.applyFormat('italic');
                } else if (e.key === 'Enter' && this.currentMode === 'edit') {
                    e.preventDefault();
                    const editor = document.getElementById('markdownEditor');
                    if (editor && editor.value.includes('```python')) {
                        this.runPythonCode();
                    }
                }
            }
        });
    }

    // ===== MODE MANAGEMENT =====
    switchMode(mode) {
        this.currentMode = mode;
        document.body.setAttribute('data-mode', mode);

        // Update nav buttons
        document.querySelectorAll('.nav-mode-btn').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.mode === mode);
        });

        // Show/hide views
        document.querySelectorAll('.view-container').forEach(view => {
            view.classList.remove('active');
        });

        const targetView = document.getElementById(mode + 'View');
        if (targetView) targetView.classList.add('active');

        if (mode === 'home') {
            this.updateStats();
            this.renderRecentDocs();
        } else if (mode === 'edit') {
            this.renderFolderTree();
        } else if (mode === 'view') {
            this.renderViewTree();
        }
    }

    // ===== FOLDER MANAGEMENT =====
    openFolderModal() {
        this.populateParentFolderSelect();
        const folderModal = document.getElementById('folderModal');
        if (folderModal) {
            folderModal.classList.add('active');
            const folderNameInput = document.getElementById('folderNameInput');
            if (folderNameInput) folderNameInput.focus();
        }
    }

    closeFolderModal() {
        const folderModal = document.getElementById('folderModal');
        if (folderModal) folderModal.classList.remove('active');
        
        const folderNameInput = document.getElementById('folderNameInput');
        if (folderNameInput) folderNameInput.value = '';
        
        const parentFolderSelect = document.getElementById('parentFolderSelect');
        if (parentFolderSelect) parentFolderSelect.value = '';
    }

    populateParentFolderSelect() {
        const select = document.getElementById('parentFolderSelect');
        if (!select) return;

        select.innerHTML = '<option value="">Root (No Parent)</option>';

        this.folders.forEach(folder => {
            const option = document.createElement('option');
            option.value = folder.id;
            option.textContent = folder.icon + ' ' + folder.name;
            select.appendChild(option);
        });
    }

    createFolder() {
        const nameInput = document.getElementById('folderNameInput');
        const parentSelect = document.getElementById('parentFolderSelect');
        const selectedIcon = document.getElementById('selectedIcon');
        
        if (!nameInput || !selectedIcon) return;

        const name = nameInput.value.trim();
        const parentId = parentSelect ? parentSelect.value || null : null;
        const icon = selectedIcon.value;

        if (!name) {
            this.showNotification('Please enter a folder name', 'error');
            return;
        }

        const folder = {
            id: Date.now(),
            name: name,
            icon: icon,
            parentId: parentId,
            createdAt: new Date().toISOString(),
            expanded: true
        };

        this.folders.push(folder);
        this.saveData();
        this.renderFolderTree();
        this.closeFolderModal();
        this.updateStats();
        this.showNotification('Folder created successfully', 'success');
    }

    getFolderPath(folderId) {
        const path = [];
        let currentId = folderId;

        while (currentId) {
            const folder = this.folders.find(f => f.id == currentId);
            if (folder) {
                path.unshift(folder);
                currentId = folder.parentId;
            } else {
                break;
            }
        }

        return path;
    }

    // ===== DOCUMENT MANAGEMENT =====
    createNewDocument() {
        const doc = {
            id: Date.now(),
            title: 'Untitled Document',
            content: '',
            category: 'general',
            folderId: this.currentFolderId,
            createdAt: new Date().toISOString(),
            updatedAt: new Date().toISOString()
        };

        this.documents.push(doc);
        this.saveData();
        this.loadDocumentInEditor(doc.id);
        this.renderFolderTree();
        this.updateStats();
    }

    loadDocumentInEditor(docId) {
        const doc = this.getDocumentById(docId);
        if (!doc) return;

        this.currentDocId = docId;
        this.currentFolderId = doc.folderId;

        const docTitle = document.getElementById('docTitle');
        const markdownEditor = document.getElementById('markdownEditor');
        const docCategory = document.getElementById('docCategory');

        if (docTitle) docTitle.value = doc.title;
        if (markdownEditor) markdownEditor.value = doc.content;
        if (docCategory) docCategory.value = doc.category;

        this.updateBreadcrumb();
        this.updatePreview();
        this.updateTreeSelection();
    }

    saveCurrentDocument() {
        if (!this.currentDocId) {
            this.showNotification('No document to save', 'error');
            return;
        }

        const doc = this.getDocumentById(this.currentDocId);
        if (!doc) return;

        const docTitle = document.getElementById('docTitle');
        const markdownEditor = document.getElementById('markdownEditor');
        const docCategory = document.getElementById('docCategory');

        if (docTitle) doc.title = docTitle.value || 'Untitled';
        if (markdownEditor) doc.content = markdownEditor.value;
        if (docCategory) doc.category = docCategory.value;
        
        doc.updatedAt = new Date().toISOString();

        this.saveData();
        this.renderFolderTree();
        this.showNotification('Document saved successfully', 'success');

        // Debug: Check if GitHub auto-commit conditions are met
        console.log('GitHub Auto-Commit Check:', {
            autoCommit: this.githubConfig.autoCommit,
            hasToken: !!this.githubConfig.token,
            docTitle: doc.title
        });

        // Auto-commit to GitHub if enabled
        if (this.githubConfig.autoCommit) {
            console.log('Attempting GitHub commit...');
            this.commitToGitHub(
                doc.title.replace(/[^a-z0-9]/gi, '_').toLowerCase(),
                doc.content,
                this.githubConfig.commitTemplate.replace('{filename}', doc.title)
            );
        }
    }

    deleteCurrentDocument() {
        if (!this.currentDocId) return;

        if (confirm('Are you sure you want to delete this document?')) {
            this.documents = this.documents.filter(d => d.id !== this.currentDocId);
            this.currentDocId = null;
            this.saveData();
            this.renderFolderTree();
            this.updateStats();

            const docTitle = document.getElementById('docTitle');
            const markdownEditor = document.getElementById('markdownEditor');
            
            if (docTitle) docTitle.value = '';
            if (markdownEditor) markdownEditor.value = '';
            
            this.updatePreview();

            this.showNotification('Document deleted', 'success');
        }
    }

    getDocumentById(id) {
        return this.documents.find(d => d.id == id);
    }

    getDocumentsByFolder(folderId) {
        return this.documents.filter(d => d.folderId == folderId);
    }

    // ===== RENDERING =====
    renderFolderTree() {
        const container = document.getElementById('folderTree');
        if (!container) return;

        container.innerHTML = '';

        // Root level folders
        const rootFolders = this.folders.filter(f => !f.parentId);
        const rootDocs = this.documents.filter(d => !d.folderId);

        rootFolders.forEach(folder => {
            container.appendChild(this.createFolderTreeItem(folder));
        });

        rootDocs.forEach(doc => {
            container.appendChild(this.createDocumentTreeItem(doc));
        });

        if (rootFolders.length === 0 && rootDocs.length === 0) {
            container.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-3); font-size: 13px;">No documents yet. Click + to create.</div>';
        }
    }

    createFolderTreeItem(folder) {
        const item = document.createElement('div');
        item.className = 'tree-item folder';
        if (folder.expanded) item.classList.add('expanded');

        const childFolders = this.folders.filter(f => f.parentId == folder.id);
        const childDocs = this.documents.filter(d => d.folderId == folder.id);
        const hasChildren = childFolders.length > 0 || childDocs.length > 0;

        item.innerHTML = `
            ${hasChildren ? '<i class="fas fa-caret-right expand-icon"></i>' : '<span style="width: 14px; display: inline-block;"></span>'}
            <span class="icon">${folder.icon}</span>
            <span class="name">${this.escapeHtml(folder.name)}</span>
        `;

        item.addEventListener('click', (e) => {
            e.stopPropagation();
            folder.expanded = !folder.expanded;
            item.classList.toggle('expanded');
            this.saveData();

            const children = item.nextElementSibling;
            if (children && children.classList.contains('tree-children')) {
                children.style.display = folder.expanded ? 'block' : 'none';
            }
        });

        const wrapper = document.createElement('div');
        wrapper.appendChild(item);

        if (hasChildren) {
            const childrenContainer = document.createElement('div');
            childrenContainer.className = 'tree-children';
            childrenContainer.style.display = folder.expanded ? 'block' : 'none';

            childFolders.forEach(child => {
                childrenContainer.appendChild(this.createFolderTreeItem(child));
            });

            childDocs.forEach(doc => {
                childrenContainer.appendChild(this.createDocumentTreeItem(doc));
            });

            wrapper.appendChild(childrenContainer);
        }

        return wrapper;
    }

    createDocumentTreeItem(doc) {
        const item = document.createElement('div');
        item.className = 'tree-item';
        if (doc.id == this.currentDocId) item.classList.add('active');

        const icons = {
            general: '',
            code: '',
            architecture: '',
            api: '',
            tutorial: '',
            notes: '',
            python: ''
        };

        item.innerHTML = `
            <span style="width: 14px; display: inline-block;"></span>
            <span class="icon">${icons[doc.category] || ''}</span>
            <span class="name">${this.escapeHtml(doc.title)}</span>
        `;

        item.addEventListener('click', (e) => {
            e.stopPropagation();
            this.loadDocumentInEditor(doc.id);
        });

        return item;
    }

    updateTreeSelection() {
        document.querySelectorAll('.tree-item').forEach(item => {
            item.classList.remove('active');
        });
        // Active state is set in renderFolderTree
        this.renderFolderTree();
    }

    updateBreadcrumb() {
        const breadcrumb = document.getElementById('breadcrumbPath');
        if (!breadcrumb) return;

        if (!this.currentDocId) {
            breadcrumb.innerHTML = '<i class="fas fa-home"></i> No document selected';
            return;
        }

        const doc = this.getDocumentById(this.currentDocId);
        if (!doc) return;

        const path = this.getFolderPath(doc.folderId);
        let html = '<i class="fas fa-home"></i>';

        path.forEach(folder => {
            html += ` <i class="fas fa-angle-right"></i> ${folder.icon} ${this.escapeHtml(folder.name)}`;
        });

        html += ` <i class="fas fa-angle-right"></i> ${this.escapeHtml(doc.title)}`;
        breadcrumb.innerHTML = html;
    }

    // ===== PREVIEW =====
    updatePreview() {
        const markdownEditor = document.getElementById('markdownEditor');
        const preview = document.getElementById('livePreview');
        
        if (!markdownEditor || !preview) return;

        const content = markdownEditor.value;

        // Convert markdown if marked is available
        let html = typeof marked !== 'undefined' ? marked.parse(content) : content;

        // Find Python executable blocks
        html = html.replace(/<pre><code class="language-python:run">([\s\S]*?)<\/code><\/pre>/g,
            (match, code) => {
                const decodedCode = this.decodeHtml(code);
                return `
                    <div class="python-executable">
                        <button class="code-run-btn" onclick="window.kb.runPythonBlock('${this.encodeForAttribute(decodedCode)}')">
                            <i class="fas fa-play"></i> Run
                        </button>
                        <pre><code class="language-python">${code}</code></pre>
                    </div>
                `;
            }
        );

        // Sanitize if DOMPurify is available
        if (typeof DOMPurify !== 'undefined') {
            html = DOMPurify.sanitize(html);
        }

        preview.innerHTML = html;

        // Re-highlight code blocks if hljs is available
        if (window.hljs) {
            preview.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
        }
    }

    // ===== TEXT FORMATTING =====
    applyFormat(action) {
        const editor = document.getElementById('markdownEditor');
        if (!editor) return;

        const start = editor.selectionStart;
        const end = editor.selectionEnd;
        const selectedText = editor.value.substring(start, end);
        let replacement = '';

        switch(action) {
            case 'bold':
                replacement = `**${selectedText || 'bold text'}**`;
                break;
            case 'italic':
                replacement = `*${selectedText || 'italic text'}*`;
                break;
            case 'strikethrough':
                replacement = `~~${selectedText || 'strikethrough'}~~`;
                break;
            case 'h1':
                replacement = `\n# ${selectedText || 'Heading 1'}\n`;
                break;
            case 'h2':
                replacement = `\n## ${selectedText || 'Heading 2'}\n`;
                break;
            case 'h3':
                replacement = `\n### ${selectedText || 'Heading 3'}\n`;
                break;
            case 'code':
                replacement = `\`${selectedText || 'code'}\``;
                break;
            case 'codeblock':
                replacement = `\n\`\`\`javascript\n${selectedText || '// code here'}\n\`\`\`\n`;
                break;
            case 'python':
                replacement = `\n\`\`\`python:run\n${selectedText || '# Python code - Click Run to execute\nprint("Hello World")'}\n\`\`\`\n`;
                const pythonPanel = document.getElementById('pythonPanel');
                if (pythonPanel) pythonPanel.classList.add('active');
                break;
            case 'ul':
                replacement = `\n- ${selectedText || 'List item'}\n`;
                break;
            case 'ol':
                replacement = `\n1. ${selectedText || 'List item'}\n`;
                break;
            case 'checklist':
                replacement = `\n- [ ] ${selectedText || 'Task'}\n`;
                break;
            case 'link':
                replacement = `[${selectedText || 'link text'}](url)`;
                break;
            case 'quote':
                replacement = `\n> ${selectedText || 'Quote'}\n`;
                break;
            case 'table':
                replacement = `\n| Header 1 | Header 2 | Header 3 |\n|----------|----------|----------|\n| Cell 1   | Cell 2   | Cell 3   |\n`;
                break;
            case 'divider':
                replacement = `\n---\n`;
                break;
        }

        editor.value = editor.value.substring(0, start) + replacement + editor.value.substring(end);
        editor.focus();
        editor.selectionStart = start + replacement.length;
        editor.selectionEnd = start + replacement.length;

        this.updatePreview();
    }

    // ===== IMAGE UPLOAD =====
    handleImageUpload(file) {
        if (!file.type.startsWith('image/')) {
            this.showNotification('Please select a valid image file', 'error');
            return;
        }

        const reader = new FileReader();
        reader.onload = (e) => {
            const imageData = e.target.result;
            const editor = document.getElementById('markdownEditor');
            if (!editor) return;

            const position = editor.selectionStart;
            const imageMd = `\n![${file.name}](${imageData})\n`;

            editor.value = editor.value.substring(0, position) + imageMd + editor.value.substring(position);
            editor.focus();
            this.updatePreview();
            this.showNotification('Image added', 'success');
        };

        reader.readAsDataURL(file);
    }

    // ===== PYTHON EXECUTION =====
    async loadPyodide() {
        if (this.pyodide) return this.pyodide;
        if (this.pyodideLoading) {
            // Wait for loading to complete
            return new Promise((resolve) => {
                const check = setInterval(() => {
                    if (this.pyodide) {
                        clearInterval(check);
                        resolve(this.pyodide);
                    }
                }, 100);
            });
        }

        this.pyodideLoading = true;
        const output = document.getElementById('pythonOutput');
        if (output) {
            output.innerHTML = '<div class="output-info"><i class="fas fa-spinner fa-spin"></i> Loading Python environment...</div>';
        }

        try {
            // Check if loadPyodide is available
            if (typeof loadPyodide === 'undefined') {
                throw new Error('Pyodide not loaded. Please check if the script is included.');
            }

            this.pyodide = await loadPyodide({
                indexURL: "https://cdn.jsdelivr.net/pyodide/v0.24.1/full/"
            });
            
            if (output) {
                output.innerHTML = '<div class="output-success"><i class="fas fa-check-circle"></i> Python ready!</div>';
            }
            this.pyodideLoading = false;
            return this.pyodide;
        } catch (err) {
            if (output) {
                output.innerHTML = `<div class="output-error"><i class="fas fa-exclamation-circle"></i> Failed to load Python: ${err.message}</div>`;
            }
            this.pyodideLoading = false;
            throw err;
        }
    }

    async runPythonCode() {
        const editor = document.getElementById('markdownEditor');
        if (!editor) return;

        const content = editor.value;

        // Extract Python code from markdown
        const pythonBlocks = [];
        const regex = /```python:run\n([\s\S]*?)```/g;
        let match;

        while ((match = regex.exec(content)) !== null) {
            pythonBlocks.push(match[1]);
        }

        if (pythonBlocks.length === 0) {
            this.showNotification('No executable Python code found. Use ```python:run ... ``` blocks.', 'error');
            return;
        }

        const output = document.getElementById('pythonOutput');
        const pythonPanel = document.getElementById('pythonPanel');
        
        if (pythonPanel) pythonPanel.classList.add('active');

        try {
            const pyodide = await this.loadPyodide();

            if (output) {
                output.innerHTML = '<div class="output-info"><i class="fas fa-play"></i> Executing Python code...</div>';
            }

            // Combine all Python blocks
            const code = pythonBlocks.join('\n\n');

            // Capture stdout
            pyodide.setStdout({ batched: (msg) => {
                if (output) {
                    const line = document.createElement('div');
                    line.className = 'output-line output-success';
                    line.textContent = msg;
                    output.appendChild(line);
                    output.scrollTop = output.scrollHeight;
                }
            }});

            // Execute
            const result = await pyodide.runPythonAsync(code);

            // Show result if there is one
            if (result !== undefined && result !== null && output) {
                const line = document.createElement('div');
                line.className = 'output-line output-success';
                line.textContent = `Result: ${result}`;
                output.appendChild(line);
            }

            if (output) {
                const success = document.createElement('div');
                success.className = 'output-success';
                success.innerHTML = '<i class="fas fa-check-circle"></i> Execution completed successfully';
                output.appendChild(success);
            }

        } catch (err) {
            if (output) {
                output.innerHTML = `<div class="output-error"><i class="fas fa-exclamation-triangle"></i> Error: ${err.message}</div>`;
            }
        }
    }

    async runPythonBlock(encodedCode) {
        const code = this.decodeFromAttribute(encodedCode);
        const pythonPanel = document.getElementById('pythonPanel');
        const output = document.getElementById('pythonOutput');
        
        if (pythonPanel) pythonPanel.classList.add('active');

        try {
            const pyodide = await this.loadPyodide();
            if (output) {
                output.innerHTML = '<div class="output-info"><i class="fas fa-play"></i> Executing...</div>';
            }

            pyodide.setStdout({ batched: (msg) => {
                if (output) {
                    const line = document.createElement('div');
                    line.className = 'output-line output-success';
                    line.textContent = msg;
                    output.appendChild(line);
                }
            }});

            const result = await pyodide.runPythonAsync(code);

            if (result !== undefined && result !== null && output) {
                const line = document.createElement('div');
                line.className = 'output-line output-success';
                line.textContent = `Result: ${result}`;
                output.appendChild(line);
            }

            if (output) {
                const success = document.createElement('div');
                success.className = 'output-success';
                success.innerHTML = '<i class="fas fa-check-circle"></i> Done';
                output.appendChild(success);
            }

        } catch (err) {
            if (output) {
                output.innerHTML = `<div class="output-error"><i class="fas fa-exclamation-triangle"></i> ${err.message}</div>`;
            }
        }
    }

    // ===== VIEW MODE =====
    renderViewTree() {
        const container = document.getElementById('viewFolderTree');
        if (!container) return;

        container.innerHTML = '';

        const rootFolders = this.folders.filter(f => !f.parentId);
        const rootDocs = this.documents.filter(d => !d.folderId);

        rootFolders.forEach(folder => {
            container.appendChild(this.createViewFolderItem(folder));
        });

        rootDocs.forEach(doc => {
            container.appendChild(this.createViewDocItem(doc));
        });

        if (rootFolders.length === 0 && rootDocs.length === 0) {
            container.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-3);">No documents to view</div>';
        }
    }

    createViewFolderItem(folder) {
        const item = document.createElement('div');
        item.className = 'tree-item folder';
        if (folder.expanded) item.classList.add('expanded');

        const childFolders = this.folders.filter(f => f.parentId == folder.id);
        const childDocs = this.documents.filter(d => d.folderId == folder.id);
        const hasChildren = childFolders.length > 0 || childDocs.length > 0;

        item.innerHTML = `
            ${hasChildren ? '<i class="fas fa-caret-right expand-icon"></i>' : '<span style="width: 14px; display: inline-block;"></span>'}
            <span class="icon">${folder.icon}</span>
            <span class="name">${this.escapeHtml(folder.name)}</span>
        `;

        item.addEventListener('click', (e) => {
            e.stopPropagation();
            folder.expanded = !folder.expanded;
            item.classList.toggle('expanded');

            const children = item.nextElementSibling;
            if (children && children.classList.contains('tree-children')) {
                children.style.display = folder.expanded ? 'block' : 'none';
            }
        });

        const wrapper = document.createElement('div');
        wrapper.appendChild(item);

        if (hasChildren) {
            const childrenContainer = document.createElement('div');
            childrenContainer.className = 'tree-children';
            childrenContainer.style.display = folder.expanded ? 'block' : 'none';

            childFolders.forEach(child => {
                childrenContainer.appendChild(this.createViewFolderItem(child));
            });

            childDocs.forEach(doc => {
                childrenContainer.appendChild(this.createViewDocItem(doc));
            });

            wrapper.appendChild(childrenContainer);
        }

        return wrapper;
    }

    createViewDocItem(doc) {
        const item = document.createElement('div');
        item.className = 'tree-item';

        const icons = {
            general: '', code: '', architecture: '',
            api: '', tutorial: '', notes: '', python: ''
        };

        item.innerHTML = `
            <span style="width: 14px; display: inline-block;"></span>
            <span class="icon">${icons[doc.category] || ''}</span>
            <span class="name">${this.escapeHtml(doc.title)}</span>
        `;

        item.addEventListener('click', () => {
            this.viewDocument(doc.id);
        });

        return item;
    }

    viewDocument(docId) {
        const doc = this.getDocumentById(docId);
        if (!doc) return;

        this.currentDocId = docId;

        // Update breadcrumb
        const viewBreadcrumb = document.getElementById('viewBreadcrumb');
        if (viewBreadcrumb) {
            const path = this.getFolderPath(doc.folderId);
            let breadcrumb = '<i class="fas fa-home"></i>';
            path.forEach(folder => {
                breadcrumb += ` / ${folder.icon} ${this.escapeHtml(folder.name)}`;
            });
            breadcrumb += ` / ${this.escapeHtml(doc.title)}`;
            viewBreadcrumb.innerHTML = breadcrumb;
        }

        // Render content
        const content = document.getElementById('documentContent');
        if (content) {
            let html = typeof marked !== 'undefined' ? marked.parse(doc.content) : doc.content;
            if (typeof DOMPurify !== 'undefined') {
                html = DOMPurify.sanitize(html);
            }
            content.innerHTML = html;

            // Highlight code if hljs is available
            if (window.hljs) {
                content.querySelectorAll('pre code').forEach(block => {
                    hljs.highlightElement(block);
                });
            }
        }

        // Show footer
        const footer = document.getElementById('docFooter');
        if (footer) {
            footer.style.display = 'block';
            const date = new Date(doc.updatedAt).toLocaleDateString('en-US', {
                year: 'numeric', month: 'long', day: 'numeric'
            });
            
            const docDate = document.getElementById('docDate');
            if (docDate) docDate.textContent = `Last updated: ${date}`;

            // Calculate read time
            const words = doc.content.split(/\s+/).length;
            const readTime = Math.ceil(words / 200);
            const docReadTime = document.getElementById('docReadTime');
            if (docReadTime) docReadTime.textContent = `${readTime} min read`;
        }
    }

    // ===== STATS & RECENT =====
    updateStats() {
        const totalDocs = document.getElementById('totalDocs');
        const totalFolders = document.getElementById('totalFolders');
        const totalCode = document.getElementById('totalCode');

        if (totalDocs) totalDocs.textContent = this.documents.length;
        if (totalFolders) totalFolders.textContent = this.folders.length;

        // Count code snippets
        let codeCount = 0;
        this.documents.forEach(doc => {
            const matches = doc.content.match(/```/g);
            if (matches) codeCount += matches.length / 2;
        });
        if (totalCode) totalCode.textContent = Math.floor(codeCount);
    }

    renderRecentDocs() {
        const container = document.getElementById('recentDocs');
        if (!container) return;

        const recent = this.documents
            .sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt))
            .slice(0, 6);

        if (recent.length === 0) {
            container.innerHTML = '<p style="color: var(--text-3); text-align: center; padding: 20px;">No documents yet</p>';
            return;
        }

        container.innerHTML = '';
        recent.forEach(doc => {
            const card = document.createElement('div');
            card.className = 'recent-doc-card';

            const preview = doc.content.substring(0, 100).replace(/[#*`]/g, '') + '...';
            const date = new Date(doc.updatedAt).toLocaleDateString();

            card.innerHTML = `
                <h4>${this.escapeHtml(doc.title)}</h4>
                <p>${this.escapeHtml(preview)}</p>
                <div class="recent-doc-meta">
                    <span>${date}</span>
                    <span>${doc.category}</span>
                </div>
            `;

            card.addEventListener('click', () => {
                this.switchMode('edit');
                this.loadDocumentInEditor(doc.id);
            });

            container.appendChild(card);
        });
    }

    // ===== IMPORT/EXPORT =====
    openImportExportModal() {
        const modal = document.getElementById('importExportModal');
        if (modal) modal.classList.add('active');
    }

    exportData() {
        const data = {
            folders: this.folders,
            documents: this.documents,
            exportDate: new Date().toISOString(),
            version: '1.0'
        };

        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `knowledgebase-${Date.now()}.json`;
        a.click();
        URL.revokeObjectURL(url);

        this.showNotification('Data exported successfully', 'success');
    }

    importData(file) {
        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                const data = JSON.parse(e.target.result);

                if (!data.folders || !data.documents) {
                    throw new Error('Invalid file format');
                }

                if (confirm(`Import ${data.documents.length} documents and ${data.folders.length} folders? This will merge with existing data.`)) {
                    this.folders = [...this.folders, ...data.folders];
                    this.documents = [...this.documents, ...data.documents];
                    this.saveData();
                    this.renderFolderTree();
                    this.updateStats();
                    this.renderRecentDocs();
                    this.showNotification('Data imported successfully', 'success');
                    const modal = document.getElementById('importExportModal');
                    if (modal) modal.classList.remove('active');
                }
            } catch (err) {
                this.showNotification('Failed to import: Invalid file format', 'error');
            }
        };
        reader.readAsText(file);
    }

    // ===== THEME =====
    toggleTheme() {
        this.theme = this.theme === 'light' ? 'dark' : 'light';
        document.body.setAttribute('data-theme', this.theme);
        localStorage.setItem('kb_theme', this.theme);

        const icon = document.querySelector('#themeToggle i');
        if (icon) {
            icon.className = this.theme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
        }
    }

    loadTheme() {
        const saved = localStorage.getItem('kb_theme');
        if (saved) {
            this.theme = saved;
            document.body.setAttribute('data-theme', this.theme);
            const icon = document.querySelector('#themeToggle i');
            if (icon) {
                icon.className = this.theme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
            }
        }
    }

    // ===== UTILITIES =====
    showNotification(message, type = 'success') {
        const container = document.querySelector('.toast-container');
        if (!container) return;

        const toast = document.createElement('div');
        toast.className = `toast ${type}`;

        const iconMap = {
            success: 'fas fa-check-circle',
            error: 'fas fa-exclamation-circle',
            info: 'fas fa-info-circle'
        };

        toast.innerHTML = `
            <i class="${iconMap[type]}"></i>
            <div class="toast-message">${message}</div>
        `;

        container.appendChild(toast);

        setTimeout(() => {
            toast.style.animation = 'toastSlideIn 0.3s ease-out reverse';
            setTimeout(() => toast.remove(), 300);
        }, 3000);
    }

    // ===== GITHUB SETTINGS UI =====
    loadGitHubSettings() {
        console.log('Loading GitHub settings...');
        
        // Safe element access
        const tokenInput = document.getElementById('githubToken');
        const ownerInput = document.getElementById('githubOwner');
        const repoInput = document.getElementById('githubRepo');
        const branchInput = document.getElementById('githubBranch');
        const commitTemplateInput = document.getElementById('commitTemplate');
        const autoCommitCheckbox = document.getElementById('autoCommit');
        const syncFolderCheckbox = document.getElementById('syncFolderStructure');

        // Only set values if elements exist
        if (tokenInput) tokenInput.value = this.githubConfig.token || '';
        if (ownerInput) ownerInput.value = this.githubConfig.owner || '';
        if (repoInput) repoInput.value = this.githubConfig.repo || '';
        if (branchInput) branchInput.value = this.githubConfig.branch || 'main';
        if (commitTemplateInput) commitTemplateInput.value = this.githubConfig.commitTemplate || 'Update documentation: {filename}';
        if (autoCommitCheckbox) autoCommitCheckbox.checked = this.githubConfig.autoCommit || false;
        if (syncFolderCheckbox) syncFolderCheckbox.checked = this.githubConfig.syncFolderStructure || false;
        
        console.log('GitHub settings loaded:', this.githubConfig);
    }

    saveGitHubSettings() {
        console.log('Saving GitHub settings...');
        
        // Safe element access
        const tokenInput = document.getElementById('githubToken');
        const ownerInput = document.getElementById('githubOwner');
        const repoInput = document.getElementById('githubRepo');
        const branchInput = document.getElementById('githubBranch');
        const commitTemplateInput = document.getElementById('commitTemplate');
        const autoCommitCheckbox = document.getElementById('autoCommit');
        const syncFolderCheckbox = document.getElementById('syncFolderStructure');

        // Only get values if elements exist
        if (tokenInput) this.githubConfig.token = tokenInput.value;
        if (ownerInput) this.githubConfig.owner = ownerInput.value;
        if (repoInput) this.githubConfig.repo = repoInput.value;
        if (branchInput) this.githubConfig.branch = branchInput.value;
        if (commitTemplateInput) this.githubConfig.commitTemplate = commitTemplateInput.value;
        if (autoCommitCheckbox) this.githubConfig.autoCommit = autoCommitCheckbox.checked;
        if (syncFolderCheckbox) this.githubConfig.syncFolderStructure = syncFolderCheckbox.checked;

        this.saveGitHubConfig();
        this.showNotification('GitHub settings saved successfully!', 'success');
        
        const modal = document.getElementById('githubModal');
        if (modal) modal.classList.remove('active');
        
        console.log('GitHub settings saved:', this.githubConfig);
    }


    // ===== APP SETTINGS UI =====
    loadAppSettings() {
        const elements = {
            themeSelect: document.getElementById('themeSelect'),
            accentColor: document.getElementById('accentColor'),
            enableParticles: document.getElementById('enableParticles'),
            enableAnimations: document.getElementById('enableAnimations'),
            editorFontSize: document.getElementById('editorFontSize'),
            autoSave: document.getElementById('autoSave'),
            livePreview: document.getElementById('livePreview'),
            pythonPreload: document.getElementById('pythonPreload')
        };

        if (elements.themeSelect) elements.themeSelect.value = this.settings.theme;
        if (elements.accentColor) elements.accentColor.value = this.settings.accentColor;
        if (elements.enableParticles) elements.enableParticles.checked = this.settings.enableParticles;
        if (elements.enableAnimations) elements.enableAnimations.checked = this.settings.enableAnimations;
        if (elements.editorFontSize) elements.editorFontSize.value = this.settings.editorFontSize;
        if (elements.autoSave) elements.autoSave.checked = this.settings.autoSave;
        if (elements.livePreview) elements.livePreview.checked = this.settings.livePreview;
        if (elements.pythonPreload) elements.pythonPreload.checked = this.settings.pythonPreload;
    }

    saveAppSettings() {
        const elements = {
            themeSelect: document.getElementById('themeSelect'),
            accentColor: document.getElementById('accentColor'),
            enableParticles: document.getElementById('enableParticles'),
            enableAnimations: document.getElementById('enableAnimations'),
            editorFontSize: document.getElementById('editorFontSize'),
            autoSave: document.getElementById('autoSave'),
            livePreview: document.getElementById('livePreview'),
            pythonPreload: document.getElementById('pythonPreload')
        };

        if (elements.themeSelect) this.settings.theme = elements.themeSelect.value;
        if (elements.accentColor) this.settings.accentColor = elements.accentColor.value;
        if (elements.enableParticles) this.settings.enableParticles = elements.enableParticles.checked;
        if (elements.enableAnimations) this.settings.enableAnimations = elements.enableAnimations.checked;
        if (elements.editorFontSize) this.settings.editorFontSize = parseInt(elements.editorFontSize.value);
        if (elements.autoSave) this.settings.autoSave = elements.autoSave.checked;
        if (elements.livePreview) this.settings.livePreview = elements.livePreview.checked;
        if (elements.pythonPreload) this.settings.pythonPreload = elements.pythonPreload.checked;

        this.saveSettings();
        this.showNotification('Settings saved successfully', 'success');
        const modal = document.getElementById('settingsModal');
        if (modal) modal.classList.remove('active');

        // Reinitialize particles if setting changed
        if (this.settings.enableParticles) {
            this.initializeParticles();
        } else if (window.pJSDom && window.pJSDom.length > 0) {
            window.pJSDom[0].pJS.fn.vendors.destroypJS();
            window.pJSDom = [];
        }
    }

    // ===== GITHUB INTEGRATION =====
    loadGitHubConfig() {
        const saved = localStorage.getItem('kb_github_config');
        if (saved) {
            this.githubConfig = JSON.parse(saved);
        }
    }

    saveGitHubConfig() {
        localStorage.setItem('kb_github_config', JSON.stringify(this.githubConfig));
        this.updateGitHubStatus();
    }

    updateGitHubStatus() {
        const statusDot = document.querySelector('#githubStatus');
        if (statusDot) {
            // Green if repo configured (token optional for public repos)
            statusDot.style.backgroundColor =
                (this.githubConfig.owner && this.githubConfig.repo) ? '#10b981' : '#ef4444';
        }
    }

    async testGitHubConnection() {
        if (!this.githubConfig.owner || !this.githubConfig.repo) {
            this.showNotification('Please fill in repository owner and name', 'error');
            return;
        }

        this.showNotification('Testing GitHub connection...', 'info');

        try {
            const url = `https://api.github.com/repos/${this.githubConfig.owner}/${this.githubConfig.repo}`;
            console.log('Testing GitHub connection to:', url);
            
            const headers = {
                'Accept': 'application/vnd.github.v3+json'
            };
            
            // Add authorization only if token exists
            if (this.githubConfig.token) {
                headers['Authorization'] = `token ${this.githubConfig.token}`;
            }

            const response = await fetch(url, { headers });
            console.log('GitHub response status:', response.status);

            if (response.ok) {
                const repo = await response.json();
                const isPublic = !repo.private;
                
                if (isPublic) {
                    if (this.githubConfig.token) {
                        this.showNotification(' Connected! Public repository with token', 'success');
                    } else {
                        this.showNotification(' Connected! Public repository - manual issue creation will be used', 'success');
                    }
                } else if (this.githubConfig.token) {
                    this.showNotification(' Connected! Private repository - using token', 'success');
                } else {
                    this.showNotification(' Private repository detected - token required for auto-sync', 'warning');
                }
                
                // Update GitHub status indicator
                this.updateGitHubStatus();
                
            } else if (response.status === 404) {
                this.showNotification(' Repository not found. Check owner and repository name.', 'error');
            } else if (response.status === 401 || response.status === 403) {
                if (this.githubConfig.token) {
                    this.showNotification(' Token invalid. Manual issue creation will be used.', 'warning');
                } else {
                    this.showNotification(' No token provided. Manual issue creation will be used.', 'info');
                }
            } else {
                this.showNotification(` Connection failed: ${response.status} ${response.statusText}`, 'error');
            }
        } catch (error) {
            console.error('GitHub connection error:', error);
            this.showNotification(' Connection error: ' + error.message, 'error');
        }
    }

    // Manual GitHub Issue Creation (No auth required)
    createManualGitHubIssue(filename, content) {
        const issueTitle = `[KB-SAVE] ${filename}`;
        
        // Create a URL that pre-fills the new issue form
        const issueUrl = `https://github.com/${this.githubConfig.owner}/${this.githubConfig.repo}/issues/new?` + 
            `title=${encodeURIComponent(issueTitle)}&` +
            `body=${encodeURIComponent(content)}&` +
            `labels=kb-save-doc,automated`;
        
        // Open in new tab - user manually submits
        window.open(issueUrl, '_blank');
        this.showNotification(' GitHub issue form opened. Please review and submit manually.', 'info');

        // Track manual commit
        const commits = JSON.parse(localStorage.getItem('kb_github_commits') || '[]');
        commits.unshift({
            filename,
            message: 'Manual issue creation',
            timestamp: new Date().toISOString(),
            status: 'manual_pending',
            issueUrl: issueUrl
        });
        localStorage.setItem('kb_github_commits', JSON.stringify(commits.slice(0, 50)));
    }

    async commitToGitHub(filename, content, message) {
        if (!this.githubConfig.owner || !this.githubConfig.repo) {
            this.showNotification('Please configure repository in GitHub settings', 'error');
            return;
        }

        try {
            const issueTitle = `[KB-SAVE] ${filename}`;
            
            console.log('Attempting GitHub issue creation:', {
                owner: this.githubConfig.owner,
                repo: this.githubConfig.repo,
                title: issueTitle,
                hasToken: !!this.githubConfig.token
            });

            // For public repos without token, use the manual method
            if (!this.githubConfig.token) {
                this.showNotification('Using manual GitHub sync (no token provided)', 'info');
                this.createManualGitHubIssue(filename, content);
                return;
            }

            const headers = {
                'Accept': 'application/vnd.github.v3+json',
                'Content-Type': 'application/json',
                'Authorization': `token ${this.githubConfig.token}`
            };

            const response = await fetch(
                `https://api.github.com/repos/${this.githubConfig.owner}/${this.githubConfig.repo}/issues`,
                {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify({
                        title: issueTitle,
                        body: content,
                        labels: ['kb-save-doc', 'automated']
                    })
                }
            );

            console.log('GitHub API response:', response.status, response.statusText);

            if (response.ok) {
                const issue = await response.json();
                this.showNotification(` Document saved to GitHub! Issue #${issue.number} created`, 'success');

                // Track the commit
                const commits = JSON.parse(localStorage.getItem('kb_github_commits') || '[]');
                commits.unshift({
                    filename,
                    message: message,
                    timestamp: new Date().toISOString(),
                    status: 'created',
                    issueNumber: issue.number
                });
                localStorage.setItem('kb_github_commits', JSON.stringify(commits.slice(0, 50)));

            } else {
                const errorData = await response.json();
                console.error('GitHub API error:', errorData);
                
                if (response.status === 401) {
                    this.showNotification('GitHub token invalid. Using manual method instead.', 'warning');
                    this.createManualGitHubIssue(filename, content);
                } else if (response.status === 403) {
                    this.showNotification('GitHub access forbidden. Using manual method.', 'warning');
                    this.createManualGitHubIssue(filename, content);
                } else {
                    this.showNotification(`GitHub error: ${errorData.message || response.statusText}`, 'error');
                }
            }
        } catch (error) {
            console.error('GitHub save error:', error);
            this.showNotification('Failed to save to GitHub, using manual method: ' + error.message, 'warning');
            this.createManualGitHubIssue(filename, content);
        }
    }


    // Manual GitHub Sync via Issue Form (No CORS issues)
    manualGitHubSync() {
        if (!this.currentDocId) {
            this.showNotification('No document selected to sync', 'error');
            return;
        }

        const doc = this.getDocumentById(this.currentDocId);
        if (!doc) return;

        const filename = doc.title.replace(/[^a-z0-9]/gi, '_').toLowerCase();
        this.createManualGitHubIssue(filename, doc.content);
    }    

    // ===== SETTINGS MANAGEMENT =====
    loadSettings() {
        const saved = localStorage.getItem('kb_settings');
        if (saved) {
            this.settings = { ...this.settings, ...JSON.parse(saved) };
        }
    }

    saveSettings() {
        localStorage.setItem('kb_settings', JSON.stringify(this.settings));
        this.applySettings();
    }

    applySettings() {
        // Apply theme
        this.theme = this.settings.theme;
        document.body.setAttribute('data-theme', this.theme);

        // Apply accent color
        document.documentElement.style.setProperty('--primary', this.settings.accentColor);

        // Apply editor font size
        const editor = document.querySelector('#docContent');
        if (editor) {
            editor.style.fontSize = `${this.settings.editorFontSize}px`;
        }

        // Apply live preview
        if (this.settings.livePreview) {
            const docContent = document.querySelector('#docContent');
            if (docContent) {
                docContent.addEventListener('input', () => this.updatePreview());
            }
        }

        // Python preload
        if (this.settings.pythonPreload && !this.pyodide && !this.pyodideLoading) {
            this.loadPyodide();
        }
    }

    initializeParticles() {
        if (this.settings.enableParticles && typeof particlesJS !== 'undefined') {
            particlesJS('particles-js', {
                particles: {
                    number: { value: 80, density: { enable: true, value_area: 800 } },
                    color: { value: this.theme === 'dark' ? '#6366f1' : '#4f46e5' },
                    shape: { type: 'circle' },
                    opacity: { value: 0.5, random: false },
                    size: { value: 3, random: true },
                    line_linked: {
                        enable: true,
                        distance: 150,
                        color: this.theme === 'dark' ? '#6366f1' : '#4f46e5',
                        opacity: 0.4,
                        width: 1
                    },
                    move: {
                        enable: true,
                        speed: 2,
                        direction: 'none',
                        random: false,
                        straight: false,
                        out_mode: 'out',
                        bounce: false
                    }
                },
                interactivity: {
                    detect_on: 'canvas',
                    events: {
                        onhover: { enable: true, mode: 'repulse' },
                        onclick: { enable: true, mode: 'push' },
                        resize: true
                    }
                },
                retina_detect: true
            });
        }
    }

    escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    decodeHtml(html) {
        const txt = document.createElement('textarea');
        txt.innerHTML = html;
        return txt.value;
    }

    encodeForAttribute(str) {
        return btoa(encodeURIComponent(str));
    }

    decodeFromAttribute(str) {
        return decodeURIComponent(atob(str));
    }

    // Test method for GitHub issue creation
    testGitHubIssueCreation() {
        const testDoc = {
            title: 'Test Document',
            content: 'This is a test document content for GitHub issue creation.',
            category: 'general'
        };

            this.commitToGitHub(
                'test_document',
                testDoc.content,
                'Test: test_document'
            );
        }
    }

    // Initialize application
    document.addEventListener('DOMContentLoaded', () => {
        window.kb = new KnowledgeBase();
    });
    </script>
</head>
<body data-mode="home">
    <!-- Particles Background -->
    <div id="particles-js"></div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Loading KnowledgeBase...</p>
        </div>
    </div>
<body data-mode="home">
    <!-- Top Navigation Bar -->
    <nav class="top-nav">
        <div class="nav-left">
            <div class="logo">
                <i class="fas fa-layer-group"></i>
                <span>KnowledgeBase</span>
            </div>
            <div class="nav-modes">
                <button class="nav-mode-btn active" data-mode="home">
                    <i class="fas fa-home"></i> Home
                </button>
                <button class="nav-mode-btn" data-mode="edit">
                    <i class="fas fa-edit"></i> Edit
                </button>
                <button class="nav-mode-btn" data-mode="view">
                    <i class="fas fa-book-open"></i> View
                </button>
            </div>
        </div>
        <div class="nav-right">
            <div class="search-container">
                <i class="fas fa-search"></i>
                <input type="text" id="globalSearch" placeholder="Search everywhere...">
            </div>
            <button id="themeToggle" class="icon-btn" title="Toggle Theme">
                <i class="fas fa-moon"></i>
            </button>
            <button id="settingsBtn" class="icon-btn" title="Settings">
                <i class="fas fa-cog"></i>
            </button>
            <button id="githubBtn" class="icon-btn github-btn" title="GitHub Integration">
                <i class="fab fa-github"></i>
                <span class="badge" id="githubStatus"></span>
            </button>
            <div class="user-avatar" title="User Profile">
                <i class="fas fa-user-circle"></i>
            </div>
        </div>
    </nav>

    <!-- HOME MODE -->
    <div id="homeView" class="view-container active">
        <div class="home-hero animate__animated animate__fadeIn">
            <div class="hero-badge">
                <i class="fas fa-star"></i> Professional Knowledge Management
            </div>
            <h1 class="gradient-text">Welcome to Your Knowledge Base</h1>
            <p>Organize, document, and execute your ideas with AI-powered features</p>
            <div class="hero-stats">
                <div class="stat-pill">
                    <i class="fas fa-rocket"></i> Fast & Powerful
                </div>
                <div class="stat-pill">
                    <i class="fas fa-shield-alt"></i> Secure & Private
                </div>
                <div class="stat-pill">
                    <i class="fab fa-python"></i> Python Enabled
                </div>
            </div>
        </div>

        <div class="home-actions animate__animated animate__fadeInUp">
            <div class="action-card glass-effect" id="createDocCard">
                <div class="action-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <i class="fas fa-file-alt"></i>
                </div>
                <h3>Create Document</h3>
                <p>Write new documentation with rich formatting</p>
                <div class="card-hover-effect"></div>
            </div>

            <div class="action-card glass-effect" id="createFolderCard">
                <div class="action-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <i class="fas fa-folder-plus"></i>
                </div>
                <h3>Create Folder</h3>
                <p>Organize documents into folders</p>
                <div class="card-hover-effect"></div>
            </div>

            <div class="action-card glass-effect" id="viewDocsCard">
                <div class="action-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <i class="fas fa-book-open"></i>
                </div>
                <h3>View Documentation</h3>
                <p>Browse and read your documents</p>
                <div class="card-hover-effect"></div>
            </div>

            <div class="action-card glass-effect" id="importDataCard">
                <div class="action-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                    <i class="fas fa-upload"></i>
                </div>
                <h3>Import/Export</h3>
                <p>Backup and restore your knowledge base</p>
                <div class="card-hover-effect"></div>
            </div>

            <div class="action-card glass-effect" id="githubSyncCard">
                <div class="action-icon" style="background: linear-gradient(135deg, #24292e 0%, #4078c0 100%);">
                    <i class="fab fa-github"></i>
                </div>
                <h3>GitHub Sync</h3>
                <p>Auto-commit changes to your repository</p>
                <div class="card-hover-effect"></div>
            </div>

            <div class="action-card glass-effect" id="aiAssistCard">
                <div class="action-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                    <i class="fas fa-magic"></i>
                </div>
                <h3>AI Assistant</h3>
                <p>Smart suggestions and auto-formatting</p>
                <div class="card-hover-effect"></div>
            </div>
        </div>

        <div class="recent-section">
            <h2><i class="fas fa-clock"></i> Recent Documents</h2>
            <div id="recentDocs" class="recent-docs"></div>
        </div>

        <div class="stats-section">
            <div class="stat-card stat-card-animated">
                <i class="fas fa-file-alt"></i>
                <div>
                    <h3 id="totalDocs">0</h3>
                    <p>Documents</p>
                </div>
                <div class="stat-sparkline"></div>
            </div>
            <div class="stat-card stat-card-animated">
                <i class="fas fa-folder"></i>
                <div>
                    <h3 id="totalFolders">0</h3>
                    <p>Folders</p>
                </div>
                <div class="stat-sparkline"></div>
            </div>
            <div class="stat-card stat-card-animated">
                <i class="fas fa-code"></i>
                <div>
                    <h3 id="totalCode">0</h3>
                    <p>Code Snippets</p>
                </div>
                <div class="stat-sparkline"></div>
            </div>
            <div class="stat-card stat-card-animated">
                <i class="fab fa-github"></i>
                <div>
                    <h3 id="totalCommits">0</h3>
                    <p>GitHub Commits</p>
                </div>
                <div class="stat-sparkline"></div>
            </div>
        </div>
    </div>

    <!-- EDIT MODE -->
    <div id="editView" class="view-container">
        <div class="split-layout">
            <!-- Folder Tree Sidebar -->
            <aside class="folder-sidebar">
                <div class="sidebar-header">
                    <h3><i class="fas fa-sitemap"></i> Structure</h3>
                    <div class="sidebar-actions">
                        <button class="icon-btn" id="newFolderBtn" title="New Folder">
                            <i class="fas fa-folder-plus"></i>
                        </button>
                        <button class="icon-btn" id="newDocInTreeBtn" title="New Document">
                            <i class="fas fa-file-plus"></i>
                        </button>
                        <button class="icon-btn" id="collapseAllBtn" title="Collapse All">
                            <i class="fas fa-compress-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="tree-search">
                    <i class="fas fa-search"></i>
                    <input type="text" id="treeSearch" placeholder="Filter...">
                </div>
                <div id="folderTree" class="folder-tree"></div>
            </aside>

            <!-- Editor Area -->
            <main class="editor-area">
                <div class="breadcrumb">
                    <span id="breadcrumbPath"></span>
                </div>

                <div class="editor-header">
                    <input type="text" id="docTitle" class="doc-title-input" placeholder="Document Title">
                    <div class="editor-meta">
                        <select id="docCategory" class="category-select">
                            <option value="general"> General</option>
                            <option value="code"> Code</option>
                            <option value="architecture"> Architecture</option>
                            <option value="api"> API</option>
                            <option value="tutorial"> Tutorial</option>
                            <option value="notes"> Notes</option>
                            <option value="python"> Python</option>
                        </select>
                        <div class="editor-actions">
                            <button id="githubSyncBtn" class="btn btn-secondary">
                                <i class="fab fa-github"></i> Sync to GitHub
                            </button>
                            <button id="saveDocBtn" class="btn btn-success">
                                <i class="fas fa-save"></i> Save
                            </button>
                            <button id="deleteDocBtn" class="btn btn-danger">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                </div>

                <div class="toolbar">
                    <div class="toolbar-group">
                        <button class="tool-btn" data-action="bold" title="Bold (Ctrl+B)">
                            <i class="fas fa-bold"></i>
                        </button>
                        <button class="tool-btn" data-action="italic" title="Italic (Ctrl+I)">
                            <i class="fas fa-italic"></i>
                        </button>
                        <button class="tool-btn" data-action="strikethrough" title="Strikethrough">
                            <i class="fas fa-strikethrough"></i>
                        </button>
                    </div>
                    <div class="toolbar-group">
                        <button class="tool-btn" data-action="h1" title="Heading 1">
                            <i class="fas fa-heading"></i>1
                        </button>
                        <button class="tool-btn" data-action="h2" title="Heading 2">
                            <i class="fas fa-heading"></i>2
                        </button>
                        <button class="tool-btn" data-action="h3" title="Heading 3">
                            <i class="fas fa-heading"></i>3
                        </button>
                    </div>
                    <div class="toolbar-group">
                        <button class="tool-btn" data-action="ul" title="Bullet List">
                            <i class="fas fa-list-ul"></i>
                        </button>
                        <button class="tool-btn" data-action="ol" title="Numbered List">
                            <i class="fas fa-list-ol"></i>
                        </button>
                        <button class="tool-btn" data-action="checklist" title="Checklist">
                            <i class="fas fa-tasks"></i>
                        </button>
                    </div>
                    <div class="toolbar-group">
                        <button class="tool-btn" data-action="code" title="Inline Code">
                            <i class="fas fa-code"></i>
                        </button>
                        <button class="tool-btn" data-action="codeblock" title="Code Block">
                            <i class="fas fa-file-code"></i>
                        </button>
                        <button class="tool-btn" data-action="python" title="Python Code">
                            <i class="fab fa-python"></i>
                        </button>
                    </div>
                    <div class="toolbar-group">
                        <button class="tool-btn" data-action="link" title="Link">
                            <i class="fas fa-link"></i>
                        </button>
                        <button class="tool-btn" data-action="image" title="Image">
                            <i class="fas fa-image"></i>
                        </button>
                        <button class="tool-btn" data-action="table" title="Table">
                            <i class="fas fa-table"></i>
                        </button>
                    </div>
                    <div class="toolbar-group">
                        <button class="tool-btn" data-action="quote" title="Quote">
                            <i class="fas fa-quote-right"></i>
                        </button>
                        <button class="tool-btn" data-action="divider" title="Divider">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>
                </div>

                <div class="editor-workspace">
                    <div class="editor-pane">
                        <textarea id="markdownEditor" placeholder="Start writing your documentation...

# Quick Guide
Use Markdown syntax for formatting:

**Bold** *Italic* ~~Strikethrough~~
`inline code`

## Python Code Execution
```python:run
# This code can be executed!
print('Hello World')
result = 2 + 2
print(f'Result: {result}')
```

[Link](url) ![Image](url)
- List item
1. Numbered item
> Quote
"></textarea>
                    </div>
                    <div class="preview-pane">
                        <div class="preview-header">
                            <h4><i class="fas fa-eye"></i> Live Preview</h4>
                            <button id="togglePreview" class="icon-btn">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                        <div id="livePreview" class="preview-content"></div>
                    </div>
                </div>

                <!-- Python Execution Panel -->
                <div id="pythonPanel" class="python-panel">
                    <div class="panel-header">
                        <h4><i class="fab fa-python"></i> Python Console</h4>
                        <div class="panel-actions">
                            <button id="runPythonBtn" class="btn btn-success btn-sm">
                                <i class="fas fa-play"></i> Run
                            </button>
                            <button id="clearOutputBtn" class="btn btn-secondary btn-sm">
                                <i class="fas fa-eraser"></i> Clear
                            </button>
                            <button id="closePythonBtn" class="icon-btn">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    <div class="panel-content">
                        <div class="python-output" id="pythonOutput">
                            <div class="output-info">
                                <i class="fas fa-info-circle"></i> Python execution ready. Click Run or use Ctrl+Enter.
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- VIEW MODE -->
    <div id="viewView" class="view-container">
        <div class="view-layout">
            <!-- Navigation Sidebar -->
            <aside class="view-sidebar">
                <div class="sidebar-header">
                    <h3><i class="fas fa-book"></i> Documentation</h3>
                </div>
                <div class="view-tree-search">
                    <i class="fas fa-search"></i>
                    <input type="text" id="viewTreeSearch" placeholder="Search docs...">
                </div>
                <div id="viewFolderTree" class="view-folder-tree"></div>
            </aside>

            <!-- Document Viewer -->
            <main class="document-viewer">
                <div class="doc-header">
                    <div class="doc-breadcrumb" id="viewBreadcrumb"></div>
                    <div class="doc-actions">
                        <button id="editCurrentBtn" class="btn btn-primary btn-sm">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button id="exportPdfBtn" class="btn btn-secondary btn-sm">
                            <i class="fas fa-file-pdf"></i> Export
                        </button>
                        <button id="shareBtn" class="btn btn-secondary btn-sm">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                    </div>
                </div>

                <article id="documentContent" class="document-content">
                    <div class="welcome-message">
                        <i class="fas fa-book-reader"></i>
                        <h2>Select a document to view</h2>
                        <p>Choose a document from the sidebar to start reading</p>
                    </div>
                </article>

                <div class="doc-footer" id="docFooter" style="display: none;">
                    <div class="doc-meta">
                        <span id="docAuthor"></span>
                        <span id="docDate"></span>
                        <span id="docReadTime"></span>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modals -->
    <!-- Create Folder Modal -->
    <div id="folderModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-folder-plus"></i> Create New Folder</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <label>Folder Name</label>
                <input type="text" id="folderNameInput" placeholder="e.g., Artificial Intelligence">
                <label>Parent Folder</label>
                <select id="parentFolderSelect">
                    <option value="">Root (No Parent)</option>
                </select>
                <label>Icon (optional)</label>
                <div class="icon-picker">
                    <button class="icon-option" data-icon="folder"></button>
                    <button class="icon-option" data-icon="brain"></button>
                    <button class="icon-option" data-icon="code"></button>
                    <button class="icon-option" data-icon="book"></button>
                    <button class="icon-option" data-icon="rocket"></button>
                    <button class="icon-option" data-icon="star"></button>
                </div>
                <input type="hidden" id="selectedIcon" value="">
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelFolderBtn">Cancel</button>
                <button class="btn btn-primary" id="createFolderBtn">Create</button>
            </div>
        </div>
    </div>

    <!-- Import/Export Modal -->
    <div id="importExportModal" class="modal">
        <div class="modal-content glass-modal">
            <div class="modal-header">
                <h3><i class="fas fa-exchange-alt"></i> Import / Export</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="import-export-options">
                    <div class="option-card">
                        <i class="fas fa-download"></i>
                        <h4>Export All Data</h4>
                        <p>Download your entire knowledge base as JSON</p>
                        <button class="btn btn-primary" id="exportAllBtn">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                    <div class="option-card">
                        <i class="fas fa-upload"></i>
                        <h4>Import Data</h4>
                        <p>Restore from a previously exported file</p>
                        <button class="btn btn-primary" id="importFileBtn">
                            <i class="fas fa-upload"></i> Import
                        </button>
                        <input type="file" id="importFileInput" accept=".json" style="display: none;">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GitHub Settings Modal -->
    <div id="githubModal" class="modal">
        <div class="modal-content glass-modal">
            <div class="modal-header">
                <h3><i class="fab fa-github"></i> GitHub Integration</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="github-status-banner">
                    <i class="fas fa-info-circle"></i>
                    <span>Configure GitHub integration to auto-save documents</span>
                </div>

                <label>Personal Access Token <span style="color: #10b981;">(Optional for public repos)</span></label>
                <div class="input-group">
                    <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxx (leave empty for public repos)">
                    <button class="btn btn-secondary" id="toggleTokenBtn">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <small style="display: block; margin-bottom: 16px; color: var(--text-3);">
                    <i class="fas fa-info-circle"></i>
                    <strong>Token NOT required for public repositories!</strong><br>
                    Only needed for private repos. Create at: github.com/settings/tokens (needs 'repo' scope)
                </small>

                <label>Repository Owner</label>
                <input type="text" id="githubOwner" placeholder="Atharv-Chaudhari" value="Atharv-Chaudhari">

                <label>Repository Name</label>
                <input type="text" id="githubRepo" placeholder="Artificial-Intelligence" value="Artificial-Intelligence">

                <label>Branch</label>
                <input type="text" id="githubBranch" placeholder="main" value="main">

                <label>Commit Message Template</label>
                <input type="text" id="commitTemplate" placeholder="Update documentation: {filename}" value="Update documentation: {filename}">

                <div class="checkbox-group">
                    <input type="checkbox" id="autoCommit">
                    <label for="autoCommit">Auto-commit on save</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="syncFolderStructure">
                    <label for="syncFolderStructure">Sync folder structure</label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="testGitHubBtn">
                    <i class="fas fa-plug"></i> Test Connection
                </button>
                <button class="btn btn-primary" id="saveGitHubBtn">
                    <i class="fas fa-save"></i> Save Settings
                </button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content glass-modal">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> Settings</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h4><i class="fas fa-palette"></i> Appearance</h4>
                    <div class="setting-item">
                        <label>Theme</label>
                        <select id="settingTheme">
                            <option value="light">Light</option>
                            <option value="dark">Dark</option>
                            <option value="auto">Auto</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label>Accent Color</label>
                        <div class="color-picker">
                            <button class="color-option" data-color="#0066FF" style="background: #0066FF;"></button>
                            <button class="color-option" data-color="#6554C0" style="background: #6554C0;"></button>
                            <button class="color-option" data-color="#36B37E" style="background: #36B37E;"></button>
                            <button class="color-option" data-color="#FF5630" style="background: #FF5630;"></button>
                            <button class="color-option" data-color="#FFAB00" style="background: #FFAB00;"></button>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="enableParticles" checked>
                        <label for="enableParticles">Enable particle effects</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="enableAnimations" checked>
                        <label for="enableAnimations">Enable animations</label>
                    </div>
                </div>

                <div class="settings-section">
                    <h4><i class="fas fa-keyboard"></i> Editor</h4>
                    <div class="setting-item">
                        <label>Font Size</label>
                        <select id="editorFontSize">
                            <option value="12">12px</option>
                            <option value="13">13px</option>
                            <option value="14" selected>14px</option>
                            <option value="16">16px</option>
                            <option value="18">18px</option>
                        </select>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="autoSave" checked>
                        <label for="autoSave">Auto-save (every 30s)</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="livePreview" checked>
                        <label for="livePreview">Live preview</label>
                    </div>
                </div>

                <div class="settings-section">
                    <h4><i class="fab fa-python"></i> Python</h4>
                    <div class="checkbox-group">
                        <input type="checkbox" id="pythonAutoLoad">
                        <label for="pythonAutoLoad">Preload Python environment</label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="resetSettings">
                    <i class="fas fa-undo"></i> Reset to Defaults
                </button>
                <button class="btn btn-primary" id="saveSettings">
                    <i class="fas fa-save"></i> Save Settings
                </button>
            </div>
        </div>
    </div>

    <!-- AI Assistant Modal -->
    <div id="aiModal" class="modal">
        <div class="modal-content glass-modal">
            <div class="modal-header">
                <h3><i class="fas fa-magic"></i> AI Assistant</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="ai-feature">
                    <i class="fas fa-lightbulb"></i>
                    <div>
                        <h4>Smart Suggestions</h4>
                        <p>Get intelligent content recommendations while writing</p>
                    </div>
                </div>
                <div class="ai-feature">
                    <i class="fas fa-spell-check"></i>
                    <div>
                        <h4>Auto-Format</h4>
                        <p>Automatically format code and markdown</p>
                    </div>
                </div>
                <div class="ai-feature">
                    <i class="fas fa-language"></i>
                    <div>
                        <h4>Grammar Check</h4>
                        <p>Improve your writing with AI-powered suggestions</p>
                    </div>
                </div>
                <div class="ai-coming-soon">
                    <i class="fas fa-rocket"></i>
                    <h4>Coming Soon!</h4>
                    <p>AI features will be available in the next update</p>
                </div>
            </div>
        </div>
    </div>

    <input type="file" id="imageUploadInput" accept="image/*" style="display: none;">

    <!-- Toast Notifications Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/11.1.1/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.6/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="https://raw.githubusercontent.com/Atharv-Chaudhari/Artificial-Intelligence/refs/heads/main/app.js"></script>
</body>
</html>
